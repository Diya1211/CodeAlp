pip install scapy

from scapy.all import sniff, IP, TCP, UDP, Raw

def process_packet(packet):
    print("\n--- Packet Captured ---")

    # Check if IP layer exists
    if packet.haslayer(IP):
        ip_layer = packet[IP]
        print(f"Source IP      : {ip_layer.src}")
        print(f"Destination IP : {ip_layer.dst}")
        print(f"Protocol       : {ip_layer.proto}")

    # Check for TCP
    if packet.haslayer(TCP):
        tcp_layer = packet[TCP]
        print("Protocol Type  : TCP")
        print(f"Source Port    : {tcp_layer.sport}")
        print(f"Destination Port: {tcp_layer.dport}")

    # Check for UDP
    elif packet.haslayer(UDP):
        udp_layer = packet[UDP]
        print("Protocol Type  : UDP")
        print(f"Source Port    : {udp_layer.sport}")
        print(f"Destination Port: {udp_layer.dport}")

    # Show payload data if available
    if packet.haslayer(Raw):
        payload = packet[Raw].load
        print(f"Payload Data   : {payload[:50]}")  # show first 50 bytes

# Start sniffing packets
print("Starting packet capture... Press Ctrl+C to stop.")
sniff(prn=process_packet, count=10)
